{% extends 'layout.html' %}
{% block title %}Gym Rankings{% endblock %}
{% block content %}

<nav class="top-nav"><a class="home" href="{{ url_for('home') }}">üè† Home</a> ¬∑ <a class="back" href="javascript:history.back()">‚Üê Back</a></nav>

<h3>Select Category</h3>
<form method="get" action="{{ url_for('home') }}" class="cat-filter">
  <select name="category" onchange="this.form.submit()">
    <option value="" {% if not selected %}selected{% endif %}>All Categories</option>
    {% for cat in all_categories %}
      <option value="{{ cat.slug }}" {% if selected==cat.slug %}selected{% endif %}>{{ cat.name }}</option>
    {% endfor %}
  </select>
</form>

{% for cat in categories.values() %}
  <section class="card">
    <h2>{{ cat.name }}</h2>
    <div class="divider"></div>
    <div class="table-wrap">
      <table class="rank-table wide">
        <thead>
          <tr>
            <th>Position</th>
            <th>Competitor</th>
            <th>Club</th>
            <th>Execution</th>
            <th>Artistry</th>
            <th>Difficulty</th>
            <th>Line Penalty</th>
            <th>Chair Penalty</th>
            <th>DIFF Penalty</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          {% for r in cat.rows[:10] %}
            <tr>
              <td class="pos">
                {% if loop.index0==0 %}ü•á{% elif loop.index0==1 %}ü•à{% elif loop.index0==2 %}ü•â{% endif %}
                {{ r.position }}
              </td>
              <td>{{ r.competitor }}</td>
              <td>{{ r.club }}</td>
              <td>{{ '%.3f'|format(r.execution) if r.execution is not none else '' }}</td>
              <td>{{ '%.3f'|format(r.artistry) if r.artistry is not none else '' }}</td>
              <td>{{ '%.3f'|format(r.difficulty) if r.difficulty is not none else '' }}</td>
              <td>{{ '%.3f'|format(r.line_penalty) if r.line_penalty is not none else '' }}</td>
              <td>{{ '%.3f'|format(r.chair_penalty) if r.chair_penalty is not none else '' }}</td>
              <td>{{ '%.3f'|format(r.diff_penalty) if r.diff_penalty is not none else '' }}</td>
              <td><strong>{{ '%.3f'|format(r.total) if r.total is not none else '' }}</strong></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <div class="see-more"><a href="{{ url_for('category_page', slug=cat.slug) }}">View full table ‚Üí</a></div>
    </div>
  </section>
{% endfor %}

{% endblock %}
